# TodoLog フロントエンド アーキテクチャ概要

## フォルダ構造

TodoLogのフロントエンドは、関心の分離と再利用性を重視した構造になっています。

```
client/
├── public/             # 静的ファイル
├── src/
│   ├── components/     # UIコンポーネント
│   │   ├── ui/         # 基本UIコンポーネント
│   │   ├── tasks/      # タスク関連コンポーネント
│   │   └── layout/     # レイアウトコンポーネント
│   ├── contexts/       # Reactコンテキスト
│   ├── hooks/          # カスタムフック
│   ├── pages/          # ページコンポーネント
│   ├── services/       # APIクライアントなどのサービス
│   ├── styles/         # グローバルスタイル
│   ├── tests/          # テストユーティリティ
│   ├── types/          # 型定義
│   └── utils/          # ユーティリティ関数
└── ...
```

### 主要ディレクトリの役割

- **components/ui/**: 再利用可能な基本UIコンポーネント（Button, Input, Selectなど）
- **components/tasks/**: タスク管理に特化したコンポーネント（TaskList, TaskForm, TaskItemなど）
- **components/layout/**: アプリケーションのレイアウトを構成するコンポーネント（Header, Sidebar, Footerなど）
- **contexts/**: アプリケーション全体で共有される状態を管理するReactコンテキスト
- **hooks/**: 再利用可能なロジックをカプセル化したカスタムフック
- **services/**: バックエンドAPIとの通信を担当するサービス
- **utils/**: 日付処理や文字列操作などの汎用ユーティリティ関数

## データフロー

TodoLogは単方向データフローを採用しています。

```
┌─────────────────┐      ┌─────────────────┐      ┌─────────────────┐
│                 │      │                 │      │                 │
│  APIサービス    │◄────►│  状態管理       │◄────►│  UIコンポーネント │
│  (services/)    │      │  (contexts/)    │      │  (components/)  │
│                 │      │                 │      │                 │
└─────────────────┘      └─────────────────┘      └─────────────────┘
```

### データフローの流れ

1. **ユーザーアクション**: ユーザーがUIコンポーネントを操作（例：タスク作成ボタンをクリック）
2. **状態更新リクエスト**: コンポーネントがコンテキストの関数を呼び出し
3. **APIリクエスト**: 必要に応じてAPIサービスがバックエンドと通信
4. **状態更新**: レスポンスに基づいてコンテキストの状態を更新
5. **UI再レンダリング**: 状態変更を検知したコンポーネントが再レンダリング

## 状態管理

TodoLogでは、React Contextを使用して状態管理を行っています。

### 主要なコンテキスト

- **TasksContext**: タスクのCRUD操作と状態管理
- **UIContext**: テーマ設定やUI設定の管理
- **NotificationContext**: 通知メッセージの管理

### 状態管理の設計原則

1. **単一の信頼できる情報源**: 各データタイプに対して単一の状態ソースを維持
2. **イミュータブルな状態更新**: 状態は常に新しいオブジェクトとして更新
3. **最小限の状態**: 派生可能なデータは状態として保持しない
4. **コロケーション**: 状態はそれを必要とするコンポーネントの最も近い共通の祖先に配置

## コンポーネント設計

TodoLogのコンポーネントは、責任の分離と再利用性を重視して設計されています。

### コンポーネントの種類

1. **プレゼンテーショナルコンポーネント**:
   - UIの表示のみを担当
   - props経由でデータと関数を受け取る
   - 内部状態は最小限（UIの状態のみ）
   - 例: Button, Input, TaskItem

2. **コンテナコンポーネント**:
   - データの取得と処理を担当
   - コンテキストからデータを取得
   - プレゼンテーショナルコンポーネントにデータを渡す
   - 例: TaskListContainer, TaskFormContainer

3. **ページコンポーネント**:
   - ルーティングのエントリーポイント
   - レイアウトとコンテナコンポーネントの組み合わせ
   - 例: TasksPage, SettingsPage

### コンポーネント設計の原則

1. **単一責任**: 各コンポーネントは1つの責任のみを持つ
2. **カプセル化**: コンポーネントの内部実装は外部から隠蔽
3. **再利用性**: 汎用的なコンポーネントは再利用可能に設計
4. **テスト容易性**: 依存関係を最小限に抑え、テストしやすく設計

## APIクライアント

APIクライアントは、バックエンドとの通信を担当するサービスレイヤーです。

### 特徴

- **Fetch API**: 標準のFetch APIを使用してHTTPリクエストを行う
- **型安全**: TypeScriptの型システムを活用して型安全な通信を実現
- **エラーハンドリング**: 統一されたエラーハンドリングメカニズム
- **キャッシュ**: 必要に応じてデータをキャッシュして再利用

### 使用例

```typescript
// タスク一覧の取得
const tasks = await apiClient.getTasks();

// 新しいタスクの作成
const newTask = await apiClient.createTask({
  title: 'タスクのタイトル',
  priority: 'medium'
});

// タスクの更新
await apiClient.updateTask(taskId, {
  completed: true
});
```

## テスト戦略

TodoLogでは、複数のレベルでテストを実施しています。

1. **単体テスト**: 個々のコンポーネント、フック、ユーティリティ関数のテスト
2. **統合テスト**: 複数のコンポーネントやサービスの連携をテスト
3. **アクセシビリティテスト**: コンポーネントのアクセシビリティをテスト

### テストツール

- **Vitest**: テストランナー
- **React Testing Library**: コンポーネントのテスト
- **MSW (Mock Service Worker)**: APIモック
- **jest-axe**: アクセシビリティテスト

## パフォーマンス最適化

TodoLogでは、以下のパフォーマンス最適化技術を採用しています。

1. **メモ化**: React.memo, useMemo, useCallbackを使用して不要な再レンダリングを防止
2. **遅延ローディング**: React.lazyとSuspenseを使用してコンポーネントを遅延ロード
3. **仮想化**: 大量のリストデータを効率的にレンダリング
4. **デバウンス/スロットル**: 頻繁に発生するイベントの処理を最適化

## アクセシビリティ

TodoLogは、WAI-ARIAガイドラインに従ってアクセシビリティを確保しています。

1. **セマンティックHTML**: 適切なHTML要素の使用
2. **ARIA属性**: 必要に応じてARIA属性を追加
3. **キーボードナビゲーション**: すべての機能をキーボードで操作可能に
4. **フォーカス管理**: モーダルやドロップダウンでの適切なフォーカス管理
5. **コントラスト比**: WCAG AAレベルのコントラスト比を確保

## 今後の拡張性

TodoLogは、将来的な機能拡張を見据えた設計になっています。

1. **プラグインシステム**: 機能を拡張するためのプラグインシステム
2. **テーマカスタマイズ**: ユーザーによるテーマのカスタマイズ
3. **多言語対応**: i18nライブラリを使用した多言語対応
4. **オフライン対応**: Service Workerを使用したオフライン対応

## 開発ガイドライン

TodoLogの開発に参加する際は、以下のガイドラインに従ってください。

1. **コーディング規約**: Biomeの設定に従ったコードフォーマット
2. **コミットメッセージ**: 「feat:」「fix:」などのプレフィックスを使用
3. **ブランチ戦略**: feature/, bugfix/, hotfix/などのプレフィックスを使用
4. **プルリクエスト**: テンプレートに従って詳細な説明を記載
5. **テスト**: 新機能には必ずテストを追加
